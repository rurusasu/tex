\documentclass{suribt}
\def\mbf#1{\mbox{\boldmath $#1$}} 
\def\rup#1{{^#1}\hspace{-0.5mm}}
%\documentclass[oneside]{suribt}% 本文が * ページ以下のときに (掲示に注意)
\usepackage{amsmath}
\usepackage[dvips]{graphicx}
\usepackage{cite}

%\title{CLデータに基づく微小摺動制御法を用いたデスクトップ型NC工作機械}
\title{\huge Xtion Pro Liveカメラを用いた\\複数移動ロボットのビジュアルフィードバック制御の基礎実験計}
%\titlewidth{}% タイトル幅 (指定するときは単位つきで)
\author{三木　康平}
\eauthor{Hiroaki kurisu}% Copyright 表示で使われる
\studentid{F112026}
\supervisor{永田寅臣　教授}% 1 つ引数をとる (役職まで含めて書く)
%\supervisor{指導教員名 役職 \and 指導教員名 役職}% 複数教員の場合，\and でつなげる
\handin{2016}{03}% 提出月. 2 つ (年, 月) 引数をとる
%\keywords{キーワード1, キーワード2} % 概要の下に表示される
\begin{document}
\maketitle %%%%%%%%%%%%%%%%%%% タイトル %%%%
\frontmatter %ここから前文
\begin{abstract}%%%%%%%%%%%%% 概要 %%%%%%%%%%%%%%%%%%%%%
本研究ではオムニホイールによる全方向車輪型移動ロボット（移動ロボット）とカメラモジュール（Xtion）を用いて，ビジュアルフィードバック（VFB）制御ができるシステムの提案を行う．Xtionから得られる画像情報をOpenCVで重心位置・移動方向・移動量について推定し，移動ロボットに命令を送信する．このようにリアルタイムでVFB制御を行い仮想的にエリア指定された目標座標に移動ロボットが動作するプログラムを作成した．また，2台の移動ロボットが協調することでロボット同士の衝突を避けるプログラムを作成した．
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%


\end{abstract}
\tableofcontents%%%%%%%%%%%%% 目次 %%%%%%%%
\mainmatter% ここから本文 %%% 本文 %%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%										%%%%%%%%%%%%
%%%%%%%%%%%%				第1章					%%%%%%%%%%%%
%%%%%%%%%%%%										%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\chapter{緒言}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
ロボットアプリケーションの再利用性や互換性を高めるために産業オートメーションにおける標準化のための取り組みがなされている~\cite{Shin-2009,Borangiu-2010,Ying-2011}．例えば，オープンアーキテクチャ型の産業用ロボットが登場して以来，これまでに加工や研磨などの自動化工程に積極的に応用されてきた．サーボ系やキネマティクスなどのオープン化により，教示レス化が可能となったことが大きな理由といえる．しかしながら，オープンアーキテクチャ型のコントローラが搭載されていても，あるロボットシステムで開発されたアプリケーションを他メーカーのロボットシステムに移植することは容易ではない．これは，制御用PCとロボットとのインタフェイス仕様がメーカーごとに異なるためである．このような背景から産業用ロボットのインタフェイスの標準化が期待されているところであるが，最近，ロボットインタフェイスの標準化のための有望なミドルウェアとしてORiN (Open Robot/Resource interface for the Network) が注目されている~\cite{Mizukawa-2001,Mizukawa-2001-2,Mizukawa-2002,Mizukawa-2004}. 

筆者らは，オープンアーキテクチャ型産業用ロボットに適用できる「CLデータに基づく軌道追従制御系」を提案しているが，これによりロボットメーカーが提供するロボット言語を用いることなく研磨や加工などのロボットアプリケーションの開発が可能となった．本稿では，ORiNミドルウェアが搭載された6自由度小型多関節型ロボットVE026Aに対して，既に提案している多軸制御用CLデータに基づく軌道追従制御法\cite{Nagata-2000}の適用を試み，WINCAP IIIを用いて移植性の検証実験を行ったので報告する．

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%										%%%%%%%%%%%%
%%%%%%%%%%%%				第2章					%%%%%%%%%%%%
%%%%%%%%%%%%										%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\chapter{Dobot}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
TechShare社が販売しているDobot Magicianは, 4自由度のロボットアームでありエンドエフェクタを取り換えることによって3Dプリンタのような積載加工, エンドミルによる切削加工ペンツールを使った印字などが行える. 筆者らは

図\ref{fig:result1}にはZ軸方向での簡単な接触実験で得られた位置と力の関係を示している．位置情報は，ロボットの内界センサから得られる各関節の角度情報をもとに順キネマティクスにより算出した，砥石先端の座標値$\rup{W}\mbf{x}\in\Re^3$のZ軸方向成分である．ただし，添え字$^W$はワーク座標系を表す．力覚情報は砥石先端がワークに接触することにより力覚センサから計測された値である．なお，砥石先端が金型ワークに接触しているとき，0.01 mm以下の細かな操作量を与えても有効な力覚値の変化として観測することができなかったため，加力時に$-$0.01 mm，減力時に0.01 mmの操作量を最小分解能としてZ軸方向に与えながら実験を行った．

さて，■のグラフは，低速で砥石先端をアルミ製金型に対して徐々に近づけ，接触後(力覚値が検出されてから)に砥石を0.01 mmずつ押付けた場合の位置と力の関係をプロットしている．接触後に合計0.3 mm押付けた時点での力覚値が36 N程度を示しているので，この区間における力制御系のおおよその実効剛性は120 N/mmである．一方，●のグラフは，その後砥石を一旦金型から離し，さきほど36 Nが発生した位置まで押付けてから今度は0.01 mmずつ徐々に砥石を離していった場合の位置と力の関係をプロットしている．図\ref{fig:result1}から0.1 mm程度のバックラッシュを確認することができる．これは一般的な垂直多関節型の産業用ロボットの繰返し位置決め精度として保証されている0.1 mmに近い値である．このことから，産業用ロボットをベースとする金型磨きシステムを構成する場合には，0.1 mmもの位置の不確かさが存在する中で，1.2 N程度の力の分解能により力制御系を設計しなければならない．もちろん，プラスチックレンズ成型用金型のように±0.01 mm以下の公差で一定間隔で並んだワークに対応することは非常に困難であると思われる．

%------------
%Figure spindle
%------------
\begin{figure}[t]
 \begin{center}
\includegraphics[width=70mm,clip]{./figure/spindle.eps}
   \caption{Polishing scene using a conventional industrial robot with a servo spindle.}
  \label{fig:spindle}
 \end{center}
\end{figure}
%------------
%Figure result1
%------------
\begin{figure}[t]
 \begin{center}
\includegraphics[width=70mm,clip]{./figure/result1.eps}
  \caption{Static relation between position and contact force in case of the conventional industrial robot.}
  \label{fig:result1}
 \end{center}
\end{figure}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{土佐電子の移動ロボットの特徴}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
実験の評価を行う時に使用するものとして土佐電子が販売をしている全方向車輪型移動ロボットを使用する．この移動ロボット特徴は，方向転換をすることなく全方向に移動できるオムニホイールを3車輪持っていること
C言語で開発することができポインタや構造体の知識などの難しい文法を考えなくても，最低限のプログラム文法でロボットを動作させることができる．このロボットの制御基盤はADuC814を搭載しておりその回路は図2Pのようになっている．また図32Pのような内部機能構成をしており，28ピンのパッケージにコンパクトに収まっている．





%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{オムニホイール}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
先述でもオムニホイールによってロボットが全方向の移動を可能にしていることを述べたが，その基本動作について説明する．
使用したオムニホイールは18(CM)/秒で進み基本動作は前進・後退・右斜め上・右斜め下・左斜め上・左斜め下・右旋回・左旋回がある．これらの動作を行うには車輪の回転方向とポートへの出力関係を理解する必要がある．その関係を図とテーブルに示す．
これらからわかるようにモーターへの信号は8ビット2進数で出力することができ動作を決めることができる．例えばモーターが図の配置としたとき前進したい場合は　　　　　　　　　　　のようにプログラムを表現することができる．



%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{ロボットの指令方法}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
次にロボットの制御プログラムを開発する手順として図10Pに示すフローチャートによってC言語から機械語に変換することで実際にロボットを動作することができます．
モーターに指令を行うときには2進数を16進数に置き換える必要があり，また動作1から動作2に移る場合はモーター出力を0にして初期化しなければならない．テーブルにそのプログラムの一部を示す．構成はモーターの初期化・





%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%										%%%%%%%%%%%%
%%%%%%%%%%%%				第3章					%%%%%%%%%%%%
%%%%%%%%%%%%										%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\chapter{画像処理}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{OpenNIとは}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
OpenNIとはカメラモジュールに対して命令を送るライブラリである．実験ではこのライブラリを用いて，まずXtionから画像情報の取得を行う．図{fig:result2}はOpenNIのシステム図を表しデバイスに命令を送っている。OpenNIではそのカメラモジュールの設定を行うことができる。例えば画素サイズやフレームレート，反転効果，取得範囲指定などモジュールに向けて仕様を変更させることができる．deph






%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{OpenCVとは}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%



%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{OpenNIの使用した関数}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%



%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{OpenCVの使用した関数}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%




%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%										%%%%%%%%%%%%
%%%%%%%%%%%%				第4章					%%%%%%%%%%%%
%%%%%%%%%%%%										%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\chapter{制御ソフト}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{移動ロボットの制御}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%






%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{ジオフェンスの設計}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%



%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%										%%%%%%%%%%%%
%%%%%%%%%%%%				第5章					%%%%%%%%%%%%
%%%%%%%%%%%%										%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\chapter{デモ実験}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{No Title}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%






%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{No Title}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%										%%%%%%%%%%%%
%%%%%%%%%%%%				第6章					%%%%%%%%%%%%
%%%%%%%%%%%%										%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\chapter{結言}
%%%%%%%%%%%%%%%%%%%%%%%%
鋳物製造の型となる木型を加工する際にスピンドルチルト式の5軸制御NC工作機械を使用すると，主軸ヘッド部が大きいために被加工物との干渉が起きやすい，動作自由度が低い，機械自体のコストも高い，といった問題点が生じている．これらを解決するために動作自由度が高く干渉が起きにくく，NC工作機械に比べて低コストで導入することができる産業用ロボットによる木型の3次元加工について検討した．しかしながら，産業用ロボットとCAD/CAMとのシステム化はNC工作機械ほど進んでいないのが現状であり，産業用ロボットを利用する場合にはティーチングペンダントを使用し，ロボットアーム先端の位置と姿勢データを入力するという時間を要する煩わしい作業が必要となっていた．この作業は教示と呼ばれており，教示作業の省力化のために産業用ロボットのCAMシステムの開発とその標準化が期待されている状況にあった．

本研究では，CAD/CAMが生成するCLデータと産業ロボットのサーボシステムとの連携という観点から「ロボット言語を用いないCAMシステム」について検討した．提案するCAMシステムは従来のCAMのメインプロセッサやポストプロセッサだけではなく，ロボットの運動学とサーボシステムを含む総合システムとして設計した．産業用ロボットRV-1Aを使用し，CLデータに対応したCAMシステムの基本設計を行うことでロボット言語を用いることなく軌道追従制御が行えるようになった．また，リバースポストプロセッサによりスピンドルチルト式の5軸制御NC工作機械用の姿勢データを含むNCデータからCLデータへの逆変換が可能となり，NCデータでもロボットアーム先端の軌道追従制御が行えるようになった．






\backmatter% ここから後付
\chapter{謝辞}%%%%%%%%%%%%%%% 謝辞 %%%%%%%
本研究は，山口東京理科大学大学院基礎工学研究科基礎工学専攻で行われたものである．
\begin{thebibliography}{}%%%参考文献%%%%%%
\bibitem{Suzuki-2018}
鈴木真太郎, 永田寅臣, 渡辺 桂吾 ``多関節ロボットのためのCAD/CAMインタフェイス", 日本機械工学会九州支部北九州講演会講演論文集, No. 188-3, 2018.

\bibitem{Borangiu-2010}
T. Borangiu, F.D. Anton and S. Anton, ``Open architecture for robot controllers,'' {\it Procs. of 2010 IEEE 19th International Workshop on Robotics in Alpe-Adria-Danube Region (RAAD)}, pp. 181--186, 2010.

\bibitem{Ying-2011}
Z. Ying, W. Tianmiao, W. Hongxing, L. Miao, ``Robot software architecture based on IPv6,'' {\it Procs. of 6th IEEE Conference on Industrial Electronics and Applications}, pp. 1666--1671, 2011.

\bibitem{Mizukawa-2001}
水川　真，尾崎安男，``産業用ロボットにおけるネットワークインタフェースの標準化活動", 東芝レビュー，Vol. 56, No. 9, pp. 7--11, 2001.

\bibitem{Mizukawa-2001-2}
M. Mizukawa, T. Koyama, T. Inukai, A. Noda, N. Kanamaru, Y. Noguchi, and N. Otera, ``Proposal of open-network-interface for industrial robots (ORiN) and its experimental evaluation,'' {\it Procs. of 2001 IEEE/ASME International Conference on Advanced Intelligent Mechatronics}, pp.  689--694, 2001.

\bibitem{Mizukawa-2002}
M. Mizukawa, H. Matsuka, T. Koyama, T. Inukai, A. Noda, H. Tezuka, Y. Noguchi, and N. Otera, ``ORiN: open robot interface for the network-- the standard and unified network interface for industrial robot applications,'' {\it Procs. of the 41st SICE Annual Conference}, pp.  925--928, 2002.

\bibitem{Mizukawa-2004}
M. Mizukawa, S. Sakakibara, and N. Otera, ``Implementation and applications of open data network interface ORiN,'' {\it Procs. of the 43rd SICE Annual Conference}, pp. 1340--1343, 2004.

\bibitem{Nagata-2000}
永田寅臣，渡辺桂吾，泉　清高，``多軸制御用ＣＬデータに基づく位置補償器を用いた産業用ロボットの倣い制御"，精密工学会誌, Vol. 66, No. 3, pp. 473--477, 2000．

\bibitem{Nagata-2013-1}
F. Nagata and K. Watanabe,
{\it Controller Design for Industrial Robots and Machine Tools: Applications to Manufacturing Processes},
Woodhead Publishing, UK, 2013.

%\bibitem{Interior-2006}
%http://www.fitc.pref.fukuoka.jp/

\bibitem{Nagata-2007}
F. Nagata, Y. Kusumoto, Y. Fujimoto, and K. Watanabe, ``Robotic sanding system for new designed furniture with free-formed surface,''
{\it Robotics and Computer-Integrated Manufacturing},
Vol. 23, No. 4, pp. 371--379, 2007.

\bibitem{Nagata-2014}
F. Nagata, A. Otsuka, K. Watanabe and Maki K. Habib, ``Fuzzy feed rate controller for a machining robot,'' {\it Procs. of the 2014 IEEE International Conference on Mechatronics and Automation (IEEE ICMA 2014)}, pp. 198--203, 2014.


\bibitem{VE026A}
VE026A ORiN Option Users' Guide, Version 1.0.0, DENSO WAVE Inc., December 14th, 2012.

\bibitem{ORiN2}
ORiN2 Programming Guide, Version 1.0.12.0, DENSO WAVE Inc., September 7th, 2012.




\end{thebibliography}


\end{document}


